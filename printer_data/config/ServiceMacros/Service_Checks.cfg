[gcode_macro _CHECKS_MENU]
gcode:
    RESPOND TYPE=command MSG="action:prompt_begin Checks"
    RESPOND TYPE=command MSG="action:prompt_button Fans|_FAN_TEST|info"
    RESPOND TYPE=command MSG="action:prompt_button Probe|_PROBE_TEST|info"
    RESPOND TYPE=command MSG="action:prompt_button Wiggle|_WIGGLE_TEST|info"
    RESPOND TYPE=command MSG="action:prompt_button Heater|_HEATER_TEST|warning"
    RESPOND TYPE=command MSG="action:prompt_button Heatbreak|_HEATBREAK_TEST|warning"
    RESPOND TYPE=command MSG="action:prompt_button Summary|_SERVICE_SUMMARY|info"
    RESPOND TYPE=command MSG="action:prompt_button Back|Service_Position|error"
    RESPOND TYPE=command MSG="action:prompt_show"

[gcode_macro _RETURN_CHECKS]
gcode:
    _CHECKS_MENU

[gcode_macro _FAN_TEST]
gcode:
    M106 S255
    G4 P1500
    M106 S0
    RESPOND TYPE=command MSG="action:prompt_begin Fans"
    RESPOND TYPE=command MSG="action:prompt_button OK|_RETURN_CHECKS|info"
    RESPOND TYPE=command MSG="action:prompt_show"

[gcode_macro _WIGGLE_TEST]
gcode:
    {% set xc = (printer.toolhead.axis_minimum.x + printer.toolhead.axis_maximum.x)/2 %}
    {% set yc = (printer.toolhead.axis_minimum.y + printer.toolhead.axis_maximum.y)/2 %}
    G90
    G0 X{xc} Y{yc}
    {% for i in range(5) %}
        G0 X{xc+5}
        G0 X{xc-5}
    {% endfor %}
    RESPOND TYPE=command MSG="action:prompt_begin Wiggle"
    RESPOND TYPE=command MSG="action:prompt_button OK|_RETURN_CHECKS|info"
    RESPOND TYPE=command MSG="action:prompt_show"

[gcode_macro _HEATER_TEST]
gcode:
    M104 S200
    TEMPERATURE_WAIT SENSOR=extruder MINIMUM=195
    M104 S0
    RESPOND TYPE=command MSG="action:prompt_begin Heater"
    RESPOND TYPE=command MSG="action:prompt_button OK|_RETURN_CHECKS|info"
    RESPOND TYPE=command MSG="action:prompt_show"

[gcode_macro _HEATBREAK_TEST]
gcode:
    M104 S150
    TEMPERATURE_WAIT SENSOR=extruder MINIMUM=145
    M106 S255
    G4 P5000
    M104 S0
    M106 S0
    RESPOND TYPE=command MSG="action:prompt_begin Heatbreak"
    RESPOND TYPE=command MSG="action:prompt_button OK|_RETURN_CHECKS|info"
    RESPOND TYPE=command MSG="action:prompt_show"

[gcode_macro _SERVICE_SUMMARY]
gcode:
    RESPOND TYPE=command MSG="action:prompt_begin Summary"
    RESPOND TYPE=command MSG="action:prompt_button OK|_RETURN_CHECKS|info"
    RESPOND TYPE=command MSG="action:prompt_show"
